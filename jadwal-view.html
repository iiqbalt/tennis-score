<!DOCTYPE html>

<head>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- will only load if it's being hosted by nodejs' -->
    <script src="/socket.io/socket.io.js"></script>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.45/moment-timezone.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/locale/id.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"
        integrity="sha512-hUhvpC5f8cgc04OZb55j0KNGh4eh7dLxd/dPSJ5VyzqDWxsayYbojWyl5Tkcgrmb/RVKCRJI1jNlRbVP4WWC4w=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->

    <link rel="stylesheet" type="text/css" href="/css/index.css" />

    <title>Tennis Score | Jadwal Pertandingan</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        .btn {
            margin: 3px;
        }

        .table-item {
            margin: 0px;
        }

        @font-face {
            font-family: sportsWorld;
            src: url("css/Sports World-Regular.ttf");
        }

        body {
            background-color: black;
            color: greenyellow;
            font-size: 2.5em;
            font-family: sportsWorld;
        }

        .table {
            background-color: black;
            color: greenyellow;
        }
        .table tr td {
            background-color: black;
            color: greenyellow;
        }

        .container {
            background-color: black;
        }

        .text-pink {
            color: #fc4cf8;
        }

        .pukul {
            color: white;
            font-size: 18px;
        }

        .vs {
            color: white;
            font-size: 10px;
        }
    </style>
</head>

<body>
    <div id="app">
        <h3 style="padding: 10px 20px;">Jadwal Pertandingan</h3>
        
        <div style="padding: 20px;">

            <table class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th class="text-pink">Match</th>
                        <th style="width: 300px;" class="text-center text-pink">Court No.#1</th>
                        <th style="width: 300px;" class="text-center text-pink">Court No.#2</th>
                        <th style="width: 300px;" class="text-center text-pink">Court No.#3</th>
                        <th style="width: 300px;" class="text-center text-pink">Court No.#4</th>
                        <th style="width: 300px;" class="text-center text-pink">Court No.#5</th>
                        <th style="width: 300px;" class="text-center text-pink">Court No.#6</th>
                    </tr>
                </thead>
                <tbody>
                    <template v-for="(item, index) in jadwals">
                        <tr>
                            <td>{{readableTanggal(item.tanggal)}}</td>
                        
                            <td style="padding: 0px;">
                                
                                <table class="table-item table table-striped table-bordered">
                                    <tr v-for="match in item.details[0].match">
                                        <td class="text-center">
                                            {{match.player_satu}}
                                            <small class="vs">vs</small>
                                            {{match.player_dua}}
                                            <div class="pukul">Pukul : {{match.jam}}</div>
                                        </td>
                                    </tr>
                                </table>

                            </td>
                        
                            <td style="padding: 0px;">
                                <table class="table-item table table-striped table-bordered">
                                    <tr v-for="match in item.details[1].match">
                                        <td class="text-center">
                                            {{match.player_satu}}
                                            <small class="vs">vs</small>
                                            {{match.player_dua}}
                                            <div class="pukul">Pukul : {{match.jam}}</div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        
                            <td style="padding: 0px;">
                                <table class="table-item table table-striped table-bordered">
                                    <tr v-for="match in item.details[2].match">
                                        <td class="text-center">
                                            {{match.player_satu}}
                                            <small class="vs">vs</small>
                                            {{match.player_dua}}
                                            <div class="pukul">Pukul : {{match.jam}}</div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        
                            <td style="padding: 0px;">
                                <table class="table-item table table-striped table-bordered">
                                    <tr v-for="match in item.details[3].match">
                                        <td class="text-center">
                                            {{match.player_satu}}
                                            <small class="vs">vs</small>
                                            {{match.player_dua}}
                                            <div class="pukul">Pukul : {{match.jam}}</div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        
                            <td style="padding: 0px;">
                                <table class="table-item table table-striped table-bordered">
                                    <tr v-for="match in item.details[4].match">
                                        <td class="text-center">
                                            {{match.player_satu}}
                                            <small class="vs">vs</small>
                                            {{match.player_dua}}
                                            <div class="pukul">Pukul : {{match.jam}}</div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        
                            <td style="padding: 0px;">
                                <table class="table-item table table-striped table-bordered">
                                    <tr v-for="match in item.details[5].match">
                                        <td class="text-center">
                                            {{match.player_satu}}
                                            <small class="vs">vs</small>
                                            {{match.player_dua}}
                                            <div>Pukul : {{match.jam}}</div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </template>
                    
                </tbody>
            </table>
        </div>

    </div>
</body>

<script>

    const BASE_URL = "http://localhost:8080"

    const {createApp} = Vue
    const app = createApp({
        data(){
            return{
                player_satu: '',
                player_dua: '',
                room: '',
                tanggal: moment().format("YYYY-MM-DD"),
                jam: moment().format("hh:mm"),
                jadwals : [],
                id: null,
                tableData : [
                    {
                        tgl: "",
                        details: [
                            {
                                court: "1",
                                match: [
                                    {
                                        players: "",
                                        time: ""
                                    }
                                ]
                            },
                            {
                                court: "2",
                                match: [
                                    {
                                        players: "",
                                        time: ""
                                    }
                                ]
                            },
                        ]
                    }
                ]
            }
        },
        methods: {
            load(){
                axios.get(BASE_URL + "/api/jadwal-view").then((res) => {
                    console.log("res", res)

                    // let array = []
                    // res.data.forEach(element => {
                    //     let findIndexTgl = array.findIndex((item) => moment(element.tanggal).format("YYYY-MM-DD") == item.tanggal)
                    //     if (findIndexTgl == -1) {
                    //         array.push({
                    //             tanggal : moment(element.tanggal).format("YYYY-MM-DD"),

                    //         })
                    //     }else{

                    //     }
                    // });

                    this.jadwals = res.data
                }).catch((err) => {
                    console.log("err", err)
                })
            },
            simpan(){
                axios.post(BASE_URL + "/api/jadwal", {
                    player_satu: this.player_satu,
                    player_dua: this.player_dua,
                    room: this.room,
                    tanggal: this.tanggal,
                    jam: this.jam,
                    id: this.id
                }).then((res) => {
                    console.log("res", res)
                    window.location.reload()
                }).catch((err) => {
                    console.log("err",err)
                })
            },
            hapus(id){
                console.log("id", id)
                axios.post(BASE_URL + "/api/jadwal/hapus", {
                    id: id
                }).then((res) => {
                    console.log("res", res)
                    window.location.reload()
                }).catch((err) => {
                    console.log("err", err)
                })
            },
            update(item){
                this.player_satu = item.player_satu
                this.player_dua = item.player_dua
                this.tanggal = moment(item.tanggal).format("YYYY-MM-DD")
                this.room = item.room
                this.id = item.id

                $("#modal-new").modal("show")
            },
            formatTanggal(item){
                let jam = item.jam
                if (item.jam == null) {
                    jam = "00:00"
                }

                let tanggal = item.tanggal.split("T")[0]
                return moment(tanggal + "T" + item.jam + ":00.000Z").format('MMMM Do YYYY') + ", " + jam;
            },
            readableTanggal(string){
                return moment(new Date(string)).format('MMMM Do YYYY')
            }
        },
        mounted(){
            this.load()
        }
    }).mount("#app")

    $(document).ready(function () {
        
    })
</script>

</html>